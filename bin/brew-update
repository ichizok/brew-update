#!/bin/bash

declare -r BREW="/usr/local/bin/brew"
declare -r BREW_LOGDIR="$HOME/Library/Logs/Homebrew"
declare -r BREW_UPDATE_LOG="$BREW_LOGDIR/update.log"

mkdir -p "$BREW_LOGDIR"

"$BREW" update >>"$BREW_UPDATE_LOG" 2>&1

declare -r TERMINAL_NOTIFIER="/usr/local/bin/terminal-notifier"
declare -r APP_ID="com.googlecode.iterm2"

[[ -x "$TERMINAL_NOTIFIER" ]] || exit 0

if [[ -n "$($BREW outdated --quiet)" ]]; then
    "$TERMINAL_NOTIFIER" -title Homebrew -message "Found outdated formulae" -activate "$APP_ID"
fi
